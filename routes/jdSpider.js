/*
 * @Author: your name
 * @Date: 2021-05-31 10:58:01
 * @LastEditTime: 2021-11-28 15:16:46
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /my_express/routes/bigFileUpload.js
 */

var express = require('express');
var router = express.Router();
var multiparty = require('multiparty')
var path = require('path')
var fs = require('fs')
var request = require('request')
var cheerio = require('cheerio')

var shortid =require('shortid')
// var db=require('../db1.js')

function spiderQuesition(questions,req,res){
    let addr=`http://api2.jiakaobaodian.com/api/open/question/question-list.htm?_r=19604815519963578102&page=1&limit=25&questionIds=${questions}`
    request({
        url:addr,
        method:'get',
        headers:{},
    },(err,res,body)=>{
        console.log(err,res,body)
    })
}

function r(t) {
    var a, i, o = Math.abs(parseInt((new Date).getTime() * Math.random() * 1e4)).toString(), n = 0;
    for (a = 0; a < o.length; a++)
        n += parseInt(o[a]);
    return i = function(t) {
        return function(a, i) {
            return i - "" + a.length <= 0 ? a : (t[i] || (t[i] = Array(i + 1).join(0))) + a
        }
    }([]),
    n += o.length,
    n = i(n, 3 - n.toString().length),
    t.toString() + o + n
}
questionIdList:[800000,800100,800200,800300,800400,800500,800600,800700,800800,800900,801000,801100,801200,801300,801400,801500,801600,801700,801800,801900,802000,802100,802200,802300,802400,802500,802600,802700,802800,802900,803000,803100,803200,803300,803400,803500,803600,803700,803800,803900,804000,804100,804200,804300,804400,804500,804600,804700,804800,804900,805000,805100,805200,805300,805400,805500,805600,805700,805800,805900,806000,806100,806200,806300,806400,806500,806600,806700,806800,806900,807000,807100,807200,807300,807400,807500,807600,807700,807800,807900,808000,808100,808200,808300,808400,808500,808600,808700,808800,808900,809000,809100,809200,809300,809400,809500,809600,809700,809800,809900,810000,810100,810200,810300,810400,810500,810600,810700,810800,810900,811000,811100,811200,811300,811400,811500,811600,811700,811800,811900,812000,812100,812200,812300,812400,812500,812600,812700,812800,812900,813000,813100,813200,813300,813400,813500,813600,813700,813800,813900,814000,814100,814200,814300,814400,814500,814600,814700,814800,814900,815000,815100,815200,815300,815400,815500,815600,815700,815800,815900,816000,816100,816200,816300,816400,816500,816600,816700,816800,816900,817000,817100,817200,817300,817400,817500,817600,817700,817800,817900,818000,818100,818200,818300,818400,818500,818600,818700,818800,818900,819000,819100,819200,819300,819400,819500,819600,819700,819800,819900,820000,820100,820200,820300,820400,820500,820600,820700,820800,820900,821000,821100,821200,821300,821400,821500,821600,821700,821800,821900,822000,822100,822200,822300,822400,822500,822600,822700,822800,822900,823000,823100,823200,823300,823400,823500,823600,823700,823800,823900,824000,824100,824200,824300,824400,824500,824600,824700,824800,824900,825000,825100,825200,825300,825400,825500,825600,825700,825800,825900,826000,826100,826200,826300,826400,826500,826600,826700,826800,826900,827000,827100,827200,827300,827400,827500,827600,827700,827800,827900,828000,828100,828200,828300,828400,828500,828600,828700,828800,828900,829000,829100,829200,829300,829400,829500,829600,829700,829800,829900,830000,830100,830200,830300,830400,830500,830600,830700,830800,830900,831000,831100,831200,831300,831400,831500,831600,831700,831800,831900,832000,832100,832200,832300,832400,832500,832600,832700,832800,832900,833000,833100,833200,833300,833400,833500,833600,833700,833800,833900,834000,834100,834200,834300,834400,834500,834600,834700,834800,834900,835000,835100,835200,835300,835400,835500,835600,835700,835800,835900,836000,836100,836200,836300,836400,1092200,1092300,1092400,1092500,1092600,1092800,1092900,1093000,1093100,1093200,1093300,1093400,1093500,1093600,1093700,1093800,1093900,1094000,1094100,1094200,1094300,1094400,1094500,1094600,1094700,1094800,1094900,1095000,1095100,1095200,1095300,1095400,1095500,1095600,1095700,1095800,1095900,1096000,1096100,1096200,1096300,1096400,1096500,1096600,1096700,1096800,1096900,1097000,1097100,1097200,1097300,1097400,1119200,1119300,1119400,1119500,1119600,1119700,1119800,1119900,1120000,1120100,1120200,1120300,1120400,1120500,1120600,1120700,1120800,1120900,1121000,1121100,1121200,1121300,1121400,1121500,1121600,1121700,1121800,1121900,1122000,1122100,1122200,1122300,1122400,1122500,1122600,1122700,1122800,1122900,1123000,1123100,1123200,1123300,1123400,1123500,1123600,1123700,1123800,1123900,1124000,1124100,1124200,1124300,1124400,1124500,1124600,1124700,1124800,1124900,1125000,1125100,1125200,1125300,1125400,1125500,1125600,1125700,1125800,1125900,1126000,1126100,1126200,1126300,1126400,1126500,1126600,1126700,1126800,1126900,1127000,1127100,1127200,1127300,1127400,1127500,1127600,1127700,1127800,1127900,1128000,1128100,1128200,1128300,1128400,1128500,1128600,1128700,1128800,1128900,1129000,1129100,1129200,1129300,1129400,1155200,1155300,1155400,1155500,1155600,1155700,1155800,1155900,1156000,1156100,1156200,1156300,1156400,1156500,1156600,1156700,1156800,1156900,1157000,1157100,1157200,1157300,1157400,1157500,1157600,1157700,1157800,1157900,1158000,1158100,1158200,1187500,1187600,1187700,1187800,1187900,1188000,1188100,1188200,1188300,1188400,5632100,5632200,5632300,5632400,10957600,10957700,10957800,10957900,10958100,11008900,11851300,11851400,11851500,11851600,11851700,11851800,11851900,11852000,11852100,11852300,11852400,11852800,11852900,11853100,11853200,11853300,11853400,11853500,11853600,11853700,11853800,11856000,11856600,11856900,11857000,11857100,11857200,11857300,11857400,11857500,11857600,11857700,11857800,11860400,11860500,11860600,11860700,11860800,11860900,11861000,11861100,11861200,11861300,11861400,11861500,11861600,11861700,11861800,11861900,11862000,11862100,11862200,11862300,11862400,11862500,11862700,11862800,11862900,11863100,11920200,11920300,11921100,11921200,11921300,11921400,11921500,11921600,11921700,11921800,11926200,11926300,11935900,11936000,11936100,11937200,11937500,11937600,11937700,11941100,11941200,11941500,11941700,11961600,11961800,11962400,11962500,11962600,11962700,11962800,11976900,11977000,11977200,11977300,11983800,11983900,11984000,11984100,11984200,11994800,11994900,11995500,11996300,11996400,11996500,11996600,11996700,11996800,11998200,11998300,11998400,11998800,11998900,11999400,11999600,11999700,11999800,11999900,12000600,12000700,12001000,12001100,12005600,12005800,12005900,12006200,12006300,12006600,12007000,12007800,12008200,12008300,12008600,12009400,12009500,12009800,12009900,12010300,12010700,12011000,12011500,12011800,12012600,12012700,12013000,12013100,12013400,12013500,12023000,12023100,12023600,12023700,12024600,12024700,12025200,12025300,12025400,12025500,12026000,12026600,12026700,12027200,12027300,12030700,12031400,12032000,12033000,12033100,12033200,12033300,12033800,12033900,12034400,12035000,12035100,12035600,12086200,12086300,12176800,12176900,12179500,12257100,12351600,12351700,12386800,12437100,12437200,12502800,12502900,12517800,12517900,12518500,12519000,12519100,12519600,12519700,12520200,12520300,12529400,12530100,12530200,12531300,13073800,13075000,13075100,13128200,13128300,13142800,13142900,13143700,13143800,13144300,13144400,13144900,13145000,13145500,13146700,13146800,13150300,13151500,13151600,13152500,13152600,13152800,13157300,13201000,13299400,13299500,13395400,13395500,13425800,13471300,13471400,13594900,13685000,13685100,13685600,13685700,13777100,13777200,13778600,13778700,13829800,13829900,13880400,13881000,836500,836600,836700,836800,836900,837000,837100,837200,837300,837400,837500,837600,837700,837800,837900,838000,838100,838200,838300,838400,838500,838600,838700,838800,838900,839000,839100,839200,839300,839400,839500,839600,839700,839800,839900,840000,840100,840200,840300,840400,840500,840600,840700,840800,840900,841000,841100,841200,841300,841400,841500,841600,841700,841800,841900,842000,842100,842200,842300,842400,842500,842600,842700,842800,842900,843000,843100,843200,843300,843400,843500,843600,843700,843800,843900,844000,844100,844200,844300,844400,844500,844600,844700,844800,844900,845000,845100,845200,845300,845400,845500,845600,845700,845800,845900,846000,846100,846200,846300,846400,846500,846600,846700,846800,846900,847000,847100,847200,847300,847400,847500,847600,847700,847800,847900,848000,848100,848200,848300,848400,848500,848600,848700,848800,848900,849000,849100,849200,849300,849400,849500,849600,849700,849800,849900,850000,850100,850200,850300,850400,850500,850600,850700,850800,850900,851000,851100,851200,851300,851400,851500,851600,851700,851800,851900,852000,852100,852200,852300,852400,852500,852600,852700,852800,852900,853000,853100,853200,853300,853400,853500,853600,853700,853800,853900,854000,854100,854200,854300,854400,854500,854600,854700,854800,854900,855000,855100,855200,855300,855400,855500,855600,855700,855800,855900,856000,856100,856200,856300,856400,856500,856600,856700,856800,856900,857000,857100,857200,857300,857400,857500,857600,857700,857800,857900,858000,858100,858200,858300,858400,858500,858600,858700,858800,858900,859000,859100,859200,859300,859400,859500,859600,859700,859800,859900,860000,860100,860200,860300,860400,860500,860600,860700,860800,860900,861000,861100,861200,861300,861400,861500,861600,861700,861800,861900,862000,862100,862200,862300,862400,862500,862600,862700,862800,862900,863000,863100,863200,863300,863400,863500,863600,863700,863800,863900,864000,864100,864200,864300,864400,864500,864600,864700,864800,864900,865000,865100,865200,865300,865400,865500,865600,865700,865800,865900,866000,866100,866200,866300,866400,866500,866600,866700,866800,866900,867000,867100,867200,867300,867400,867500,867600,1097500,1097600,1158300,1158400,1158500,1158600,1158700,1158800,1158900,1159000,1159100,1159200,1159300,1159400,1159500,1159600,1159700,1159800,1159900,1160000,1160100,1160200,1160300,1160400,1160500,10958000,10958200,10958300,11852500,11855300,11855400,11855500,11855600,11855700,11855800,11855900,11856700,11856800,11857900,11858000,11858100,11858200,11858300,11858400,11858500,11858600,11858700,11858800,11858900,11859000,11859100,11859200,11859300,11859400,11859500,11859600,11859700,11859800,11859900,11860000,11860100,11860200,11860300,11936200,11936300,11995200,11995300,11995400,11996200,11999000,12007400,12007500,12008700,12011100,12030600,12030800,12351000,12531400,12984500,12984600,13145600,13501000,13564200,13736200,13736300,13777700,13777800,13777900,867700,867800,867900,868000,868100,868200,868300,868400,868500,868600,868700,868800,868900,869000,869100,869200,869300,869400,869500,869600,869700,869800,869900,870000,870100,870200,870300,870400,870500,870600,870700,870800,870900,871000,871100,871200,871300,871400,871500,871600,871700,871800,871900,872000,872100,872200,872300,872400,872500,872600,872700,872800,872900,873000,873100,873200,873300,873400,873500,873600,873700,873800,873900,874000,874100,874200,874300,874400,874500,874600,874700,874800,874900,875000,875100,875200,875300,875400,875500,875600,875700,875800,875900,876000,876100,876200,876300,876400,876500,876600,876700,876800,876900,877000,877100,877200,877300,877400,877500,877600,877700,877800,877900,878000,878100,878200,878300,878400,878500,878600,878700,878800,878900,879000,879100,879200,879300,879400,879500,879600,879700,879800,879900,880000,880100,880200,880300,880400,880500,880600,880700,880800,880900,881000,881100,881200,881300,881400,881500,881600,881700,881800,881900,882000,882100,882200,882300,882400,882500,882600,882700,882800,882900,883000,883100,883200,883300,883400,883500,883600,883700,883800,883900,884000,884100,884200,884300,884400,884500,884600,884700,884800,884900,885000,885100,885200,885300,885400,885500,885600,885700,885800,885900,886000,886100,886200,886300,1097700,1097800,1097900,1098000,1098100,1098200,1098300,1098400,1098500,1098600,1098700,1098800,1098900,1099000,1099100,1099200,1099300,1099400,1099500,1099600,1099700,1099800,1099900,1100000,1100100,1100200,1100300,1100400,1100500,1100600,1100700,1100800,1100900,1101000,1101100,1101200,1101300,1101400,1101500,1101600,1101700,1101800,1101900,1129500,1129600,1129700,1129800,1129900,1130000,1130100,1130200,1130300,1130400,1130500,1130600,1130700,1130800,1130900,1131000,1131100,1131200,1131300,1131400,1131500,1131600,1131700,1131800,1131900,1132000,1132100,1132200,1132300,1132400,1132500,1132600,1132700,1132800,1132900,1133000,1133100,1133200,1133300,1133400,1133500,1133600,1133700,1133800,1133900,1134000,1134100,1134200,1134300,1134400,1134500,1134600,1134700,1154200,11852200,11852600,11852700,11853000,11853900,11854000,11854100,11854200,11854300,11854400,11854500,11854600,11854700,11854800,11854900,11855000,11855100,11855200,11856100,11856200,11856300,11856400,11856500,11862600,11863000,11921900,11922000,11922100,11936400,11936500,11936600,11936700,11936800,11936900,11937300,11937400,11941300,11941400,11941600,11941800,11961400,11961500,11961700,11977100,11999500,12001400,12001500,12001600,12005500,12006700,12007100,12007900,12009000,12009100,12010200,12010600,12011400,12011900,12012200,12012300,12026100,12029600,12029700,12030900,12031500,12032100,12034500,12035700,12179600,12256100,12256200,12256600,12257200,12351100,12352200,12352300,12386900,12517200,12517300,12527000,12527100,12529300,12530700,12530800,12532200,12532300,12532500,12533000,12533100,12533200,12533700,12533800,12534300,12534400,12534900,12535000,12535500,12535600,12931900,12932000,12932700,12932800,12933000,12933500,12933600,12933700,13073900,13074400,13074500,13128800,13128900,13129400,13129500,13146100,13146200,13150400,13150900,13151000,13152700,13156100,13156200,13156700,13156800,13157400,13200900,13425700,13500900,13562400,13562500,13563000,13563100,13563600,13563700,13564300,13595000,13649400,13649500,13778000,13778100,13829200,13829300,13880500,13881100,13881200,13881300,886400,886500,886600,886700,886800,886900,887000,887100,887200,887300,887400,887500,887600,887700,887800,887900,888000,888100,888200,888300,888400,888500,888600,888700,888800,888900,889000,889100,889200,889300,889400,889500,889600,889700,889800,889900,890000,890100,890200,890300,890400,890500,890600,890700,890800,890900,891000,891100,891200,891300,891400,891500,891600,891700,891800,891900,892000,892100,892200,892300,892400,892500,892600,892700,892800,892900,893000,893100,893200,893300,893400,893500,893600,893700,893800,893900,894000,894100,894200,894300,894400,894500,894600,894700,894800,894900,895000,895100,895200,895300,895400,895500,895600,895700,895800,895900,896000,896100,896200,896300,896400,896500,896600,896700,896800,896900,897000,897100,897200,1102000,1102100,1160600,1160700,1160800,1160900,1161000,1161100,1161200,1161300,1161400,1161500,1161600,1161700,1161800,1161900,1162000,1162100,1162200,1162300,1162400,1162500,1162600,1162700,1162800,1162900,1163000,1163100,1163200,1163300,11937000,11937100,11994700,11995600,12002000,12002100,12002200,12002300,12002400,12002500,12002600,12002700,12002800,12002900,12003000,12003100,12003200,12003300,12003400,12003500,12003600,12003700,12003800,12003900,12004000,12004100,12004200,12004300,12004400,12004500,12004600,12004700,12004800,12004900,12005000,12005100,12005200,12005300,12005400,12256500,12518400]
function spider(str,req, res) {
    let addr = `https://api2.jiakaobaodian.com/api/open/exercise/sequence.htm?_r=${r(1)}&carType=car&cityCode=320500&course=kemu1&_=${Math.random()}`
    request({
        url: addr,
        method: 'get',
        headers: {
           
        },
    }, (err, res1, body) => {
        console.log(res1.body,'res1',typeof res1)
        let data=res1.body.data||[]
        console.log(res1.body.success,data,'datat')
        if(Array.isArray(data)&&data.length){

            let tempList=data.splice(0,20)
            console.log(tempList)
            spiderQuesition(tempList.join(','),req,res)
        }
    })
}
router.get('/', function (req, res, next) {
    spider(req, res)
    res.send('success')
});

module.exports = router;